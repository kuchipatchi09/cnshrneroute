<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>QPI LOADING</title>
  <style>
    :root{
      /* Palette */
      --bg:#0b0d10;               /* 페이지 배경 */
      --fg:#eef3ff;               /* 텍스트 */
      --accent:#9ecbff;           /* 그라디언트 시작 */
      --accent-2:#b79dff;         /* 그라디언트 끝 */
      --accent-3:#c2fff9;         /* 스파클 */
      --white:#ffffff;

      /* Bar geometry */
      --w:clamp(280px, 72vw, 620px);
      --h:20px;
      --radius:16px;
      --border:#ffffffaa;         /* 외곽선 색 */
      --border-weak:#ffffff33;    /* 내부 하이라이트 라인 */
      --border-w:1.2px;           /* 외곽선 두께 */

      /* Motion */
      --duration:1.05s;           /* 스트라이프 이동 */
      --shine:2.2s;               /* 샤인 스윕 */
      --p:0;                      /* 진행률(0~100) */

      /* Effects */
      --glow:40px;                /* 바 글로우 */
      --noise:0.035;              /* 필름 노이즈 강도 */
    }

    /* Apple-ish Font Stack (CR Cobane 우선) */
    :root{ --font:"CR Cobane", "SF Pro Display", "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; }

    html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font-family:var(--font);}
    .wrap{min-height:100%;display:grid;place-items:center;position:relative;overflow:hidden}

    /* ===== Ambient background (블러 블랍 + 노이즈) ===== */
    .blob{position:absolute;filter:blur(64px);opacity:.55;pointer-events:none}
    .b1{width:36vw;height:36vw;min-width:320px;min-height:320px;left:-10vw;top:-8vh;border-radius:999px;background:radial-gradient(closest-side, #7aa2ff40, #0000 70%);}    
    .b2{width:30vw;height:30vw;min-width:260px;min-height:260px;right:-8vw;bottom:-6vh;border-radius:999px;background:radial-gradient(closest-side, #9d7aff33, #0000 70%);}  

    /* subtle film noise */
    .noise{position:absolute;inset:0;pointer-events:none;mix-blend-mode:soft-light;opacity:.16;
      background-image: repeating-radial-gradient(#fff1 0 0.5px, #0000 0.5px 1px);
      background-size: 3px 3px;
      animation: grain 6s steps(6) infinite;
    }
    @keyframes grain{ to{transform:translate3d(0.5rem,0,0)} }

    /* ===== Quarter-Pie ornaments (모서리 장식) ===== */
    .qp{position:absolute;width:120px;height:120px;opacity:.25;filter:blur(0.4px);}
    .qp::before{content:"";position:absolute;inset:0;border-radius:120px 0 0 0;
      background:conic-gradient(from 210deg, #fff0 0 70deg, #ffffff18 80deg, #fff0 140deg);
    }
    .qp.tl{left:6vw;top:8vh; transform:rotate(0deg); animation: qprot 14s linear infinite;}
    .qp.br{right:8vw;bottom:10vh; transform:rotate(180deg); animation: qprot 16s linear infinite reverse;}
    @keyframes qprot{ to{ transform:rotate(360deg);} }

    /* ===== Percentage ===== */
    .pct{font-weight:800;letter-spacing:.02em;font-variant-numeric:tabular-nums;line-height:1; 
         font-size:clamp(22px,6vw,38px);margin-bottom:18px;
         text-shadow:0 0 24px color-mix(in oklab, var(--accent) 28%, transparent);
    }

    /* ===== Glass Panel (bar frame) ===== */
    .panel{position:relative;display:grid;gap:14px;place-items:center;padding:26px 22px;border-radius:20px;
      background: linear-gradient(180deg, #ffffff0a, #ffffff05 60%, #00000018), rgba(255,255,255,0.02);
      border: 1px solid #ffffff1f;
      box-shadow: 0 10px 30px #0008, inset 0 1px 1px #ffffff22, inset 0 -1px 2px #000a;
      -webkit-backdrop-filter: blur(12px); backdrop-filter: blur(12px);
    }

    /* ===== Bar ===== */
    .bar{position:relative;width:var(--w);height:var(--h);border-radius:var(--radius);overflow:hidden;isolation:isolate;
      background: linear-gradient(180deg, #0f131a, #0c1016);
      /* White outline (outside) */
      box-shadow: 0 0 0 var(--border-w) var(--border), inset 0 1px 0 #ffffff1a, inset 0 -1px 0 #00000066,
                  0 12px 28px #0009;
    }
    /* Inner white hairline */
    .bar::before{content:"";position:absolute;inset:1px;border-radius:calc(var(--radius) - 1px); pointer-events:none;
      box-shadow: inset 0 0 0 1px var(--border-weak);
    }

    /* Fill */
    .fill{position:absolute;inset:0;height:100%;width:calc(var(--p) * 1%);border-radius:inherit;
      background:
        linear-gradient(90deg, var(--accent), var(--accent-2)),
        repeating-linear-gradient(45deg, #ffffff26 0 10px, #ffffff08 10px 20px);
      background-size:auto 100%, 28px 100%;
      background-position:0 0, 0 0;
      filter: saturate(118%);
      box-shadow: 0 0 0 1px #ffffff10 inset, 0 0 var(--glow) color-mix(in oklab, var(--accent-2) 60%, transparent);
      transform: translateZ(0);
      animation: stripes var(--duration) linear infinite;
    }
    /* Gloss highlight */
    .fill::after{content:"";position:absolute;inset:0;border-radius:inherit;background:linear-gradient(180deg,#ffffff66,#ffffff00 42%);mix-blend-mode:overlay}

    /* Shine sweep */
    .shine{position:absolute;inset:-40% -10%;background:linear-gradient(100deg,#fff0,#ffffff12 35%,#ffffff22 50%,#ffffff12 65%,#fff0);
      transform:skewX(-18deg);mix-blend-mode:screen;pointer-events:none;animation:sweep var(--shine) ease-in-out infinite}

    /* Reflection under bar */
    .reflect{position:absolute;inset:auto 0 -24px 0;height:24px;border-radius:0 0 var(--radius) var(--radius);
      background: linear-gradient(180deg, color-mix(in oklab, var(--accent-2) 30%, transparent), transparent);
      filter: blur(10px); opacity:.55; clip-path: inset(6px 0 0 0 round 0 0 var(--radius) var(--radius)); pointer-events:none;
    }

    /* Sparks at the edge */
    .spark{position:absolute;bottom:50%;left:calc(var(--p) * 1%);width:8px;height:8px;border-radius:999px;pointer-events:none;
      background:radial-gradient(circle at 30% 30%, #fff, #fff0 60%);
      filter: drop-shadow(0 0 10px var(--accent-3)); transform:translate(-50%,50%); opacity:0; animation:spark 1.6s ease-in-out infinite}
    .spark.s2{animation-delay:.12s}.spark.s3{animation-delay:.24s}.spark.s4{animation-delay:.36s}.spark.s5{animation-delay:.48s}

    /* Animations */
    @keyframes stripes{to{background-position:0 0, 28px 0}}
    @keyframes sweep{0%{transform:translateX(-120%) skewX(-18deg)}50%{transform:translateX(20%) skewX(-18deg)}100%{transform:translateX(120%) skewX(-18deg)}}
    @keyframes spark{0%{opacity:0;transform:translate(calc(-50% + 0px),50%) scale(.5)}15%{opacity:1}50%{transform:translate(calc(-50% + 8px),-8px) scale(1)}100%{opacity:0;transform:translate(calc(-50% + 14px),-28px) scale(.6)}}

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){ .fill,.shine,.spark,.noise,.qp{animation:none !important} }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="blob b1"></div>
    <div class="blob b2"></div>
    <div class="qp tl"></div>
    <div class="qp br"></div>
    <div class="noise"></div>

    <section class="panel" aria-label="QPI Loading">
      <div class="pct" id="qpiPct">0%</div>
      <div class="bar">
        <div class="fill" id="qpiFill"></div>
        <div class="shine"></div>
        <div class="reflect"></div>
        <span class="spark s1"></span>
        <span class="spark s2"></span>
        <span class="spark s3"></span>
        <span class="spark s4"></span>
        <span class="spark s5"></span>
      </div>
    </section>
  </div>

  <script>
    (function(){
      const root = document.documentElement;
      const pctEl = document.getElementById('qpiPct');
      const sparks = Array.from(document.querySelectorAll('.spark'));
      const clamp = n => Math.max(0, Math.min(100, Math.round(n)));

      function setProgress(n){
        const p = clamp(n);
        root.style.setProperty('--p', p);
        pctEl.textContent = p + '%';
        const left = `calc(${p}% )`;
        sparks.forEach(s => s.style.left = left);
      }
      window.setQPIProgress = setProgress;

      // 데모: 자동 진행 (원하면 삭제)
      let start = performance.now();
      const D = 2600; // ms
      function tick(now){
        const t = Math.min(1, (now - start)/D);
        const eased = t < .5 ? 4*t*t*t : 1 - Math.pow(-2*t + 2, 3)/2; // easeInOutCubic
        setProgress(eased*100);
        if(t<1) requestAnimationFrame(tick);
      }
      requestAnimationFrame(tick);
    })();
  </script>
</body>
</html>
